I"µP<p>This post is going to be something of a combination riddle and blog post.</p>

<h1 id="the-setup">The setup</h1>

<p>There are $N$ doors indexed by $1,..,N$ along a wall and they‚Äôre all closed. Then for each $i\in{1,2,\dots,N}$, you toggle every $i$ door. So at first ($i = 1$) you toggle every door. Then $i=2$ you toggle every second door ‚Äì the even doors ($2, 4, 6, \dots,$).</p>

<!-- more -->

<h2 id="the-task">The task</h2>

<p>Given $N$, describe the ‚Äúdoor is closed‚Äù function. By that I mean, which doors are open and which are closed at the end?</p>

<h1 id="solution">Solution:</h1>

<div class="hint">
  <p>Only the perfect squares are open at the end. So $1,4,9,16,\dots$ are open, and $2,3,5,6,7,8,\dots$ are closed.</p>
</div>

<h1 id="explanation">Explanation</h1>

<p><strong>NOTE: Spoilers below!</strong></p>

<p>So there are really two philosophies to solving this riddle, and they each have their merits.</p>

<h2 id="theory">Theory</h2>

<p>The first philosophy I‚Äôm talking about is what I‚Äôll call the <em>theory based</em> approach. For this approach we‚Äôll investigate what‚Äôs driving the system. By that we mean, given a number $m\leq N$, how many times will that $m$ be toggled? Note that we‚Äôre not investigating the task directly, but rather something a lot deeper and more specific.</p>

<p>Well, a number $m$ is toggled exactly once per divisor. For instance, the number $6$ is toggled 4 times ‚Äì once at $1,2,3,6$ ‚Äì and hence is closed at the end. $9$, on the other hand only gets toggled $3$ times ‚Äì $1,3,9$ ‚Äì and hence is open at the end.</p>

<p>So how many divisors does a given number have? For that, we‚Äôll use some beautiful number theory (the number theory we‚Äôre using isn‚Äôt deep or anything, but any number theory is beautiful really). So any counting number $m$ can be written as a product of unique primes to non-negative integer exponents. So, mathematically, what I‚Äôm saying is:</p>

<p>[\begin{align<em>}
m =&amp; \prod p_i^{\alpha_i}
\end{align</em>}]</p>

<p>Since every number can be written that way, all $m$‚Äôs divisors can be written that way too. By definition, any divisor of $m$ must be $\prod p_i^{\lambda_i}$ such that for each $i$, $0 \leq \lambda_i \leq \alpha_i$ ‚Äì and each such collection of $\lambda_i$ determines a unique divisor. So how many such numbers can we create? Clearly: $\prod\limits_i(\alpha_i + 1)$ because we can have up to $\alpha_i$ powers of $p_i$, but we could also have 0 of them. So there are $\alpha_i + 1$ many.</p>

<p>So now we can ask which numbers have an odd number divisors? Those will be the ones left open and the others will be closed. Well an odd number of divisors means that $\gamma = \prod\limits_i(\alpha_i + 1)$ is odd. But since $\gamma$ is odd, then none if its divisors can be even, and hence $\alpha_i + 1$ must be odd for each $i$. But that means $\alpha_i$ must be even for each $i$. And that‚Äôs the exact description of a perfect square.</p>

<p>Another way to use this understanding is that for every divisor there‚Äôs a pair, a buddy. But only if it‚Äôs a perfect square will there be a divisor whose buddy is itself, thereby making an odd number of divisors. But this is still based on our theoretical understanding of the scenario.</p>

<h1 id="data-science-approach">Data Science Approach</h1>

<p>The second approach is one that‚Äôs particularly useful if the theory is very costly to investigate (for whatever reason). For this approach we‚Äôll just collect a bunch of data, and see what fits. For this example, we‚Äôll collect just the data that‚Äôs directly what we‚Äôre looking to question. Let‚Äôs do up to 11 (just to pick a random number) letting 0 denote closed and 1 open.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">iteration</th>
      <th style="text-align: center">1</th>
      <th style="text-align: center">2</th>
      <th style="text-align: center">3</th>
      <th style="text-align: center">4</th>
      <th style="text-align: center">5</th>
      <th style="text-align: center">6</th>
      <th style="text-align: center">7</th>
      <th style="text-align: center">8</th>
      <th style="text-align: center">9</th>
      <th style="text-align: center">10</th>
      <th style="text-align: center">11</th>
      <th style="text-align: center">12</th>
      <th style="text-align: left">NOTES</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: left">¬†</td>
    </tr>
    <tr>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: left">¬†</td>
    </tr>
    <tr>
      <td style="text-align: center">2</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: left">¬†</td>
    </tr>
    <tr>
      <td style="text-align: center">3</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: left">¬†</td>
    </tr>
    <tr>
      <td style="text-align: center">4</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: left">¬†</td>
    </tr>
    <tr>
      <td style="text-align: center">5</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: left">transcription error</td>
    </tr>
    <tr>
      <td style="text-align: center">6</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: left">¬†</td>
    </tr>
    <tr>
      <td style="text-align: center">7</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: left">¬†</td>
    </tr>
    <tr>
      <td style="text-align: center">8</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: left">¬†</td>
    </tr>
    <tr>
      <td style="text-align: center">9</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: left">¬†</td>
    </tr>
    <tr>
      <td style="text-align: center">10</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">1</td>
      <td style="text-align: left">¬†</td>
    </tr>
    <tr>
      <td style="text-align: center">11</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: left">¬†</td>
    </tr>
    <tr>
      <td style="text-align: center">12</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">1</td>
      <td style="text-align: center">0</td>
      <td style="text-align: center">0</td>
      <td style="text-align: left">¬†</td>
    </tr>
  </tbody>
</table>

<p>At this point we might already have noticed a pattern. The first is 1, then $1 + 3 = 4$. Then $4 + 2\cdot 3 = 10$. So the next one should be $10 + 3 \cdot 3 = 19$, which we know from the first approach is wrong, so we collect more data and reject this hypothesis. We can imagine that with enough data we‚Äôd start to notice that 9 and 10 are outliers and even probably notice the transcription error at iteration 5 and end up with something like this.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">index</th>
      <th style="text-align: left">open?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">1</td>
      <td style="text-align: left">0</td>
    </tr>
    <tr>
      <td style="text-align: left">2</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">3</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">4</td>
      <td style="text-align: left">0</td>
    </tr>
    <tr>
      <td style="text-align: left">5</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">6</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">7</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">8</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">9</td>
      <td style="text-align: left">0</td>
    </tr>
    <tr>
      <td style="text-align: left">10</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">11</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">12</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">13</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">14</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">15</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">16</td>
      <td style="text-align: left">0</td>
    </tr>
  </tbody>
</table>

<p>And we conclude that the pattern is 1, then skip 3 (to 4), then skip 5 (to 9), then skip 7 (to 16), etc. and confirm it with some out-of-sample:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">index</th>
      <th style="text-align: left">open?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">17</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">18</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">19</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">20</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">21</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">22</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">23</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">24</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">25</td>
      <td style="text-align: left">0</td>
    </tr>
    <tr>
      <td style="text-align: left">26</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">27</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">28</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">29</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">30</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">31</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">32</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">33</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">34</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">35</td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left">36</td>
      <td style="text-align: left">0</td>
    </tr>
    <tr>
      <td style="text-align: left">37</td>
      <td style="text-align: left">1</td>
    </tr>
  </tbody>
</table>

<p>and I‚Äôm satisfied. But that pattern isn‚Äôt very illuminating, and it‚Äôs only valid in the statistical sense. But either way, we get an answer<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote">1</a></sup>.</p>

<h1 id="the-problem">The Problem</h1>

<p>What if we work in a field where data accrual is very slow (think Finance, Economics, or any such field). Clearly this approach has some pretty deep flaws for us. Our out-of-sample grows too slowly to be able to make conclusions like we made at the end there, and we‚Äôre stuck in the first realm where all data has errors and there are a plethora of theories that look great (in sample). And even if we hold out some data as ‚Äúout-of-sample‚Äù and try to do everything right, we can still over-fit to that sample.</p>

<p>Luckily for us, there‚Äôs a lot of autocorrelation in these things. So if you‚Äôve done everything properly and found something that works on the hold-out, it‚Äôs shouldn‚Äôt be too surprising if it works well for at least a short period on true out-of-sample, even if the thing is over-fit, but that‚Äôs not particularly satisfying.</p>

<p>So how else should we go about this? The economist‚Äôs approach, perhaps? It seems sensible at first glance; you get to build off of the tremendous work of the mathematical community and potentially get conclusive answers. We can certainly model things with increasing complexity and beauty (unrelated), but at the end of the day the only way to assess the validity of these models is through out-of-sample predictions. You know, the way Physicists do it. But we can‚Äôt really do that here, so we do like we said we would and have a hold out, etc. and we‚Äôre already back to the data-science approach but with more story-telling. And naturally, since we want to pretend like we‚Äôre doing something more rigorous that data-science, we judge this largely on the sensibility of the stories. But all that means is that we‚Äôre unwilling to accept theories that are counter-intuitive ‚Äì sorry Einstein, your theory of relativity isn‚Äôt wanted here.</p>

<p>So either we do the data science approach, or we do the ‚Äúsensibility‚Äù based approach, which is itself based on itself. Why do people prefer the sensibility based approach? If you‚Äôre reading this, please really do <a href="mailto:aaron@niskin.org?Subject=Economics%20data-science%20blog-post">email</a> me your thoughts on this ‚Äì I‚Äôd love to hear other opinions here.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>We can show that these two solutions are equivalent by induction. Clearly it‚Äôs true for 1 (1 is a perfect square and is how we defined the start of the sequence). Now imagine a square of size $n$ and let‚Äôs see how many we have to add to get to a square with side-length $n+1$. Well, we have to add $n$ to each side, then 1 for the corner. So we add $2n + 1$. So for instance, if $n=1$ (the base case) then the next perfect square would be $n + (2n+1) = 1 + 3 = 4$. Indeed!¬†<a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>
:ET